package br.gov.siscomex.portalunico.ccta.api;

import javax.validation.constraints.NotNull;
import javax.ws.rs.GET;
import javax.ws.rs.HeaderParam;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;
import javax.ws.rs.QueryParam;
import javax.ws.rs.core.Response;

import br.gov.siscomex.portalunico.ccta.model.RecebimentoRepresentation;
import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import io.swagger.annotations.ApiParam;
import io.swagger.annotations.ApiResponse;
import io.swagger.annotations.ApiResponses;

/**
 * Controle de Carga e Trânsito Importação - Modal Aéreo
 *
 * <p><h3 id=\"cct-importa-o\">CCT Importação</h3><a rel=\"noopener noreferrer\" target=\"_blank\" href=\"../en\"><img border=\"0\" alt=\"gb\" src=\"../images/icon_gb_64.png\" width=\"32\" height=\"16\">English</a><h4>Introdução</h4><p>Bem-vindo à Application Programming Interface (API) provisória de interação entre transportadores (Cias. Aéreas), agentes de carga, operadores de remessa postal/expressa, recintos aduaneiros e o novo Sistema de Controle de Carga e Trânsito (CCT Importação - Modal Aéreo). Trata-se de um conjunto de rotinas e padrões de programação para acesso a um aplicativo de software baseado nos padrões Web, que permitirá a manifestação e gestão do fluxo logístico de viagens e cargas dentro do Portal Único de Comércio Exterior.</p><p>A documentação a seguir descreve os serviços da versão atual do sistema, disponível no ambiente de validação do setor privado. Os demais serviços encontram-se em desenvolvimento. Não há, até o momento, versão disponível para uso em produção. O intuito da API é permitir que as empresas possam iniciar seus testes, preparando as adaptações necessárias em seus sistemas. As informações encaminhadas para os endpoints, neste momento, não terão valor legal, nem serão reaproveitadas em produção.</p><p>Nesta versão, todos os serviços listados devem ser acessados por empresas cadastradas como Transportador ou Agente de Carga, utilizando o perfil de acesso “TRANSPORT”. Os recintos aduaneiros devem utilizar os serviços disponibilizados pelo Sistema Recintos. Os operadores de remessa postal/expressa serão incluídos em versão futura.</p><p>Para a utilização dos serviços do CCT Importação – Modal Aéreo, a autenticação via certificação digital é obrigatória. Na seção “Introdução” da API do Portal Único de Comércio Exterior, podem ser encontradas as orientações gerais sobre os padrões de comunicação dos serviços, os procedimentos para autenticação e os códigos de resposta das requisições.</p><p>Os arquivos referentes à manifestação de viagens e cargas devem seguir o padrão Cargo XML da IATA (Associação Internacional de Transportes Aéreos). Para conhecimento dos elementos de dados, estrutura e formato do padrão XSD, deve-se buscar a informação no site da IATA (www.iata.org). Nesta API, serão detalhadas somente as informações solicitadas de forma diferente do padrão IATA.</p><p>Serão solicitados os arquivos XFFM, XFWB, XFZB e XFHL, a serem enviados pelos serviços abaixo, descritos em maiores detalhes nas suas respectivas seções desta API:</p><ul><li>Informar Viagem - XFFM (Flight Manifest)</li><li>Informar Conhecimento de Carga - XFWB (Freight Waybill)</li><li>Informar Conhecimento de Carga House - XFZB (House Air Waybill)</li><li>Informar Associação Master e House - XFHL (House Manifest)</li></ul><p>Os arquivos somente serão recebidos caso o XML esteja de acordo com o XSD da IATA. Os arquivos corretamente validados passarão à situação &quot;<em>Received</em>&quot; e receberão um número de protocolo associado ao recebimento desse arquivo, sendo encaminhados para processamento. Os arquivos que não forem validados pelo XSD da IATA terão situação &quot;<em>Rejected</em>&quot; e não receberão número de protocolo.</p><p>Após a validação do XSD, será realizado o processamento do conteúdo dos campos dos arquivos. Este processamento inclui verificações, tais como: se o campo foi informado vazio ou acima do tamanho permitido, se as informações constam no cadastro da Receita Federal (CPF, CNPJ), etc., com vistas à gravação do dado na base. Os arquivos corretamente processados passarão à situação &quot;<em>Processed</em>&quot;, e os que apresentarem algum tipo de erro passarão para &quot;<em>Rejected</em>&quot;.</p><p>A qualquer momento, a situação dos arquivos enviados pode ser consultada pelos seguintes serviços descritos nesta API:</p><ul><li>Consultar Situação de Arquivos por Data</li><li>Consultar Situação de Arquivos por Número de Protocolo</li></ul><p>Durante o processamento, haverá batimento do conteúdo dos dados com tabelas de domínio. Os domínios que estão sendo validados e que podem causar rejeição de arquivo referem-se a:</p><ul><li>Aeroportos (código com três posições) - IATA Airport Code (&#42;)</li><li>Companhia Aérea (número com três posições e código com duas posições) - IATA Airline Codes</li><li>Indicador de Parcialidade de carga numa viagem - IATA Code List 1.15</li><li>Moeda (código alfanumérico com três posições) - ISO 4217</li><li>Países (sigla com duas posições) – ISO 3166</li><li>Recinto Aduaneiro (código com sete posições) – site da Receita Federal do Brasil</li><li>Unidade de Medida (Peso) - rec20_Rev10e_2014.xls do site <a href=\"http://www.unece.org/uncefact/codelistrecs.html\">http://www.unece.org/uncefact/codelistrecs.html</a></li><li>Unidade de Medida (Volume) - IATA Code List 1.20</li><li>Voos - Código de voo com duas posições alfanuméricas referentes à Companhia Aérea e quatro posições numéricas referentes ao número do voo.</li></ul><p>(&#42;) Na versão atual, será aceita uma lista reduzida de aeroportos, informada no final desta seção. Em versão futura, a lista será ampliada para todos os aeroportos cadastrados.</p><p>A lista de campos a serem informados e a definição de se eles são obrigatórios ou opcionais seguirão, via de regra, os padrões estabelecidos pela IATA, passando pela validação do XSD. As exceções serão mencionadas explicitamente na descrição dos serviços na API, fazendo parte do processamento dos arquivos. Os tipos e tamanhos de campos também seguirão, via de regra, os padrões estabelecidos pela IATA e, quando não validados pelo XSD, serão verificados no processamento.</p><p>Serão processados os seguintes tipos de operação para os arquivos:</p><ul><li>XFFM – Creation</li><li>XFWB, XFZB, XFHL – Creation, Update e Deletion</li></ul><p>Os arquivos XFFM, XFWB, XFZB e XFHL podem ser enviados em qualquer ordem, desde que cumpram com os prazos estabelecidos pela Receita Federal do Brasil.</p><p>O escopo atual do projeto se encontra restrito a voos regulares. Voos não regulares serão objeto de versões futuras.</p><p>Os serviços de recebimento e consulta de arquivos, a princípio, não estarão disponíveis no horário de 1:00h às 3:00h, em virtude de parada programada dos sistemas de comércio exterior.</p><p>Lista de aeroportos aceitos na versão atual:</p><table><thead><tr><th>Sigla País</th><th>País</th><th>Código Aeroporto</th><th>Descrição Aeroporto</th></tr></thead><tbody><tr><td>AE</td><td>EMIRADOS ÁRABES UNIDOS</td><td>DXB</td><td>Dubai International Airport</td><td></td></tr><tr><td>AU</td><td>AUSTRÁLIA</td><td>CBR</td><td>Canberra Airport</td><td></td></tr><tr><td>AU</td><td>AUSTRÁLIA</td><td>SYD</td><td>Sydney Airport</td><td></td></tr><tr><td>AU</td><td>AUSTRÁLIA</td><td>MEL</td><td>Melbourne Airport</td><td></td></tr><tr><td>AR</td><td>ARGENTINA</td><td>CPC</td><td>San Martin Des Andes</td><td></td></tr><tr><td>AR</td><td>ARGENTINA</td><td>EZE</td><td>Ministro Pistarini International Airport</td><td></td></tr><tr><td>AR</td><td>ARGENTINA</td><td>IRJ</td><td>Capitan V A Almonacid Airport</td><td></td></tr><tr><td>AR</td><td>ARGENTINA</td><td>LUQ</td><td>Brigadier Mayor D Cesar Raul Ojeda Airport</td><td></td></tr><tr><td>AR</td><td>ARGENTINA</td><td>MDQ</td><td>Ástor Piazzola International Airport</td><td></td></tr><tr><td>AR</td><td>ARGENTINA</td><td>REL</td><td>Almirante Marco Andres Zar Airport</td><td></td></tr><tr><td>BE</td><td>BÉLGICA</td><td>ANR</td><td>Antwerp International Airport</td><td></td></tr><tr><td>BE</td><td>BÉLGICA</td><td>BRU</td><td>Brussels Airport</td><td></td></tr><tr><td>BR</td><td>BRASIL</td><td>AAG</td><td>Avelino Vieira Airport</td><td></td></tr><tr><td>BR</td><td>BRASIL</td><td>CGR</td><td>Campo Grande Airport</td><td></td></tr><tr><td>BR</td><td>BRASIL</td><td>CNF</td><td>Tancredo Neves International Airport</td><td></td></tr><tr><td>BR</td><td>BRASIL</td><td>CWB</td><td>Afonso Pena Airport</td><td></td></tr><tr><td>BR</td><td>BRASIL</td><td>FLB</td><td>Cangapara Airport</td><td></td></tr><tr><td>BR</td><td>BRASIL</td><td>GIG</td><td>Rio Galeao – Tom Jobim International Airport</td><td></td></tr><tr><td>BR</td><td>BRASIL</td><td>GRU</td><td>Guarulhos - Governador Andre Franco Montoro International Airport</td><td></td></tr><tr><td>BR</td><td>BRASIL</td><td>POA</td><td>Salgado Filho Airport</td><td></td></tr><tr><td>BR</td><td>BRASIL</td><td>VCP</td><td>Viracopos Airport</td><td></td></tr><tr><td>BR</td><td>BRASIL</td><td>VOT</td><td>Votuporanga Airport</td><td></td></tr><tr><td>CA</td><td>CANADÁ</td><td>YYZ</td><td>Toronto Pearson International Airport</td><td></td></tr><tr><td>CA</td><td>CANADÁ</td><td>YVR</td><td>Vancouver International Airport</td><td></td></tr><tr><td>CN</td><td>CHINA</td><td>SHA</td><td>Shanghai Hongqiao International Airport</td><td></td></tr><tr><td>CN</td><td>CHINA</td><td>NGB</td><td>Ningbo Lishe International Airport</td><td></td></tr><tr><td>CN</td><td>CHINA</td><td>PEK</td><td>Aeroporto Internacional de Pequim - Capital</td><td></td></tr><tr><td>DE</td><td>ALEMANHA</td><td>AGB</td><td>Augsburg Airport</td></tr><tr><td>DE</td><td>ALEMANHA</td><td>BBJ</td><td>Bitburg Airport</td></tr><tr><td>DE</td><td>ALEMANHA</td><td>BYU</td><td>Bayreuth Airport</td></tr><tr><td>DE</td><td>ALEMANHA</td><td>DTM</td><td>Dortmund Airport</td></tr><tr><td>DE</td><td>ALEMANHA</td><td>FRA</td><td>Frankfurt am Main Airport</td></tr><tr><td>DE</td><td>ALEMANHA</td><td>THF</td><td>Berlin-Tempelhof International Airport</td></tr><tr><td>ES</td><td>ESPANHA</td><td>MAD</td><td>Madrid-Barajas Airport</td></tr><tr><td>FR</td><td>FRANÇA</td><td>CDG</td><td>Charles de Gaulle Airport</td></tr><tr><td>FR</td><td>FRANÇA</td><td>ORY</td><td>Orly Airport</td></tr><tr><td>GB</td><td>REINO UNIDO</td><td>LHR</td><td>Heathrow Airport</td></tr><tr><td>HK</td><td>HONG KONG</td><td>HKG</td><td>Aeroporto Internacional de Hong Kong</td></tr><tr><td>IL</td><td>ISRAEL</td><td>TLV</td><td>Ben Gurion Airport</td></tr><tr><td>IT</td><td>ITÁLIA</td><td>FCO</td><td>Leonardo da Vinci-Fiumicino Airport</td></tr><tr><td>IT</td><td>ITÁLIA</td><td>LIN</td><td>Linate Airport</td></tr><tr><td>JP</td><td>JAPÃO</td><td>AKJ</td><td>Asahikawa Airport</td></tr><tr><td>JP</td><td>JAPÃO</td><td>KIX</td><td>Kansai International Airport</td></tr><tr><td>JP</td><td>JAPÃO</td><td>NGO</td><td>Chubu Centrair International Airport</td></tr><tr><td>JP</td><td>JAPÃO</td><td>NGS</td><td>Nagasaki Airport</td></tr><tr><td>JP</td><td>JAPÃO</td><td>NRT</td><td>Narita International Airport</td></tr><tr><td>JP</td><td>JAPÃO</td><td>UKY</td><td>Kyoto</td></tr><tr><td>MX</td><td>MÉXICO</td><td>MEX</td><td>Mexico City International Airport</td></tr><tr><td>NL</td><td>PAÍSES BAIXOS</td><td>AMS</td><td>Amsterdam Airport Schiphol</td></tr><tr><td>NL</td><td>PAÍSES BAIXOS</td><td>RTM</td><td>Rotterdam The Hague Airport</td></tr><tr><td>PT</td><td>PORTUGAL</td><td>LIS</td><td>Humberto Delgado Airport</td></tr><tr><td>PT</td><td>PORTUGAL</td><td>OPO</td><td>Francisco Sá Carneiro Airport</td></tr><tr><td>SG</td><td>SINGAPURA</td><td>SIN</td><td>Singapore Changi Airport</td></tr><tr><td>SG</td><td>SINGAPURA</td><td>XSP</td><td>Seletar Airport</td></tr><tr><td>SN</td><td>SENEGAL</td><td>DKR</td><td>Blaise Diagne International Airport</td></tr><tr><td>TR</td><td>TURQUIA</td><td>IST</td><td>Istanbul Airport</td></tr><tr><td>US</td><td>ESTADOS UNIDOS</td><td>AEX</td><td>Alexandria International Airport</td></tr><tr><td>US</td><td>ESTADOS UNIDOS</td><td>JFK</td><td>John F Kennedy International Airport</td></tr><tr><td>US</td><td>ESTADOS UNIDOS</td><td>MDW</td><td>Chicago Midway International Airport</td></tr><tr><td>US</td><td>ESTADOS UNIDOS</td><td>MIA</td><td>Miami International Airport</td></tr><tr><td>US</td><td>ESTADOS UNIDOS</td><td>SPG</td><td>Albert Whitted Airport</td></tr><tr><td>US</td><td>ESTADOS UNIDOS</td><td>ZWU</td><td>Washington Union Station</td></tr><tr><td>ZA</td><td>ÁFRICA DO SUL</td><td>JNB</td><td>OR Tambo International Airport</td></tr></tbody></table><h4>URLs de Acesso</h4><p>Para utilizar os servi&ccedil;os dispon&iacute;veis nessa API deve-se seguir o seguinte padr&atilde;o de URL:</p><p><em>https://{ambiente}/<strong>ccta</strong>/api/{servi&ccedil;o}</em></p><p>Onde, em <strong>{ambiente}</strong> deve-se informar o ambiente desejado dentro os ambientes dispon&iacute;veis na tabela abaixo e em <strong>{servi&ccedil;o}</strong> utilizar a URI do servi&ccedil;o desejado.</p><style type=\"text/css\">  .tg  {border-collapse:collapse;border-color:#bbb;border-spacing:0;width: 604px;}  .tg td{background-color:#E0FFEB;border-color:#bbb;border-style:solid;border-width:1px;color:#594F4F;    font-family:Arial, sans-serif;font-size:14px;overflow:hidden;padding:10px 5px;word-break:normal;}  .tg th{background-color:#9DE0AD;border-color:#bbb;border-style:solid;border-width:1px;color:#493F3F;    font-family:Arial, sans-serif;font-size:14px;font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}  .tg .tg-cabecalho{text-align:left;vertical-align:top}  .tg .tg-corpo{border-color:inherit;text-align:left;vertical-align:top}</style><table class=\"tg\" style=\"width: 604px;\"><thead>  <tr>    <th class=\"tg-cabecalho\"><span style=\"font-weight:bold\">Nome do Ambiente</span></th>    <th class=\"tg-cabecalho\"><span style=\"font-weight:bold\">URL de acesso</span></th>  </tr></thead><tbody>  <tr>    <td class=\"tg-corpo\">Ambiente de Validação da Empresas</td>    <td class=\"tg-corpo\">val.portalunico.siscomex.gov.br</td>  </tr>  <tr>    <td class=\"\\tg-corpo\">Ambiente de Produção</td>    <td class=\"\\tg-corpo\">portalunico.siscomex.gov.br</td>  </tr></tbody></table><p>&nbsp;</p><p><strong>Exemplo:</strong> Para o servi&ccedil;o \"Consultar Situação de Arquivos por Número de Protocolo\" a URI &eacute; \"ext/check/received-files/protocolo\".</p><p>Logo, abaixo temos um exemplo de URL completa considerando o ambiente de Valida&ccedil;&atilde;o, consumindo este servi&ccedil;o </p><p><em>https://val.portalunico.siscomex.gov.br/ccta/api/ext/check/received-files/protocolo</em></p>
 *
 */
@Path("/")
@Api(value = "/", description = "")
public interface ServiosDeConsultaDeArquivosRecebidosApi  {

    /**
     * Consultar Situação de Arquivos por Data
     *
     * &lt;p&gt;Consulta, para uma determinada data, a lista de arquivos enviados que passaram pela validação do XSD da IATA, tendo número de protocolo gerado. O retorno traz a situação atual do processamento de cada arquivo.&lt;/p&gt;&lt;p&gt;As situações podem ser:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;em&gt;Received&lt;/em&gt; – Aguardando processamento.&lt;/li&gt;&lt;li&gt;&lt;em&gt;Processed&lt;/em&gt; – Processamento realizado com sucesso, com gravação dos dados na base.&lt;/li&gt;&lt;li&gt;&lt;em&gt;Rejected&lt;/em&gt; – Arquivo rejeitado por erro no processamento. Neste caso, a lista de erros encontrados é exibida.&lt;/li&gt;&lt;/ul&gt;
     *
     */
    @GET
    @Path("/ext/check/received-files")
    @Produces({ "application/json" })
    @ApiOperation(value = "Consultar Situação de Arquivos por Data", notes = "<p>Consulta, para uma determinada data, a lista de arquivos enviados que passaram pela validação do XSD da IATA, tendo número de protocolo gerado. O retorno traz a situação atual do processamento de cada arquivo.</p><p>As situações podem ser:</p><ul><li><em>Received</em> – Aguardando processamento.</li><li><em>Processed</em> – Processamento realizado com sucesso, com gravação dos dados na base.</li><li><em>Rejected</em> – Arquivo rejeitado por erro no processamento. Neste caso, a lista de erros encontrados é exibida.</li></ul>", tags={ "Serviços de Consulta de Arquivos Recebidos" })
    @ApiResponses(value = { 
        @ApiResponse(code = 200, message = "Operação realizada com sucesso", response = RecebimentoRepresentation.class, responseContainer = "List"),
        @ApiResponse(code = 204, message = "Operação realizada com sucesso. Nenhum conteúdo retornado"),
        @ApiResponse(code = 400, message = "Requisição mal formatada"),
        @ApiResponse(code = 401, message = "Usuário não autenticado ou autenticação inválida"),
        @ApiResponse(code = 403, message = "Usuário não tem permissão de acesso ao recurso"),
        @ApiResponse(code = 404, message = "Recurso não encontrado"),
        @ApiResponse(code = 422, message = "Erro(s) de validação da camada de negócio"),
        @ApiResponse(code = 500, message = "Erro interno no servidor") })
    public Response consultarRecepcao(@QueryParam("TPP-ID") String TPP_ID, @HeaderParam("abi") String abi,  @NotNull @ApiParam(value = "Data de início período recebimento do arquivo  Tamanho: 10  Formato YYYY-MM-DD",required=true)  @QueryParam("startDate") String startDate,  @NotNull @ApiParam(value = "Data de término período recebimento do arquivo  Tamanho: 10  Formato YYYY-MM-DD",required=true)  @QueryParam("endDate") String endDate, @ApiParam(value = "JSON Web Token (JWT) contendo as informações do usuário. Este token é recuperado no parâmetro Set-Token no response da autenticação" ,required=true)@HeaderParam("Authorization") String authorization, @ApiParam(value = "Token de prevenção contra ataques CSRF. Este token é recuperado no parâmetro X-CSRF-Token no response da autenticação" ,required=true)@HeaderParam("X-CSRF-Token") String xCSRFToken,  @ApiParam(value = "CNPJ do Transportador (Cia Aérea) ou do Agente de Carga responsável pelo envio do arquivo  Tamanho mínimo: 8  Tamanho máximo: 14  Formato: NNNNNNNNNNNNNN")  @QueryParam("cnpj") String cnpj);

    /**
     * Consultar Situação de Arquivos por Número de Protocolo
     *
     * &lt;p&gt;Consulta, para um determinado número de protocolo, a situação atual do processamento do arquivo enviado. O número de protocolo é aquele gerado pelo sistema após o recebimento do arquivo, quando o mesmo passa pela validação do XSD da IATA.&lt;/p&gt;&lt;p&gt;As situações podem ser:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;em&gt;Received&lt;/em&gt; – Aguardando processamento.&lt;/li&gt;&lt;li&gt;&lt;em&gt;Processed&lt;/em&gt; – Processamento realizado com sucesso, com gravação dos dados na base de dados.&lt;/li&gt;&lt;li&gt;&lt;em&gt;Rejected&lt;/em&gt; – Arquivo rejeitado por erro no processamento. Neste caso, a lista de erros encontrados é exibida.&lt;/li&gt;&lt;/ul&gt;
     *
     */
    @GET
    @Path("/ext/check/received-files/{protocolNumber}")
    @Produces({ "application/json" })
    @ApiOperation(value = "Consultar Situação de Arquivos por Número de Protocolo", notes = "<p>Consulta, para um determinado número de protocolo, a situação atual do processamento do arquivo enviado. O número de protocolo é aquele gerado pelo sistema após o recebimento do arquivo, quando o mesmo passa pela validação do XSD da IATA.</p><p>As situações podem ser:</p><ul><li><em>Received</em> – Aguardando processamento.</li><li><em>Processed</em> – Processamento realizado com sucesso, com gravação dos dados na base de dados.</li><li><em>Rejected</em> – Arquivo rejeitado por erro no processamento. Neste caso, a lista de erros encontrados é exibida.</li></ul>", tags={ "Serviços de Consulta de Arquivos Recebidos" })
    @ApiResponses(value = { 
        @ApiResponse(code = 200, message = "Operação realizada com sucesso", response = RecebimentoRepresentation.class),
        @ApiResponse(code = 204, message = "Operação realizada com sucesso. Nenhum conteúdo retornado"),
        @ApiResponse(code = 400, message = "Requisição mal formatada"),
        @ApiResponse(code = 401, message = "Usuário não autenticado ou autenticação inválida"),
        @ApiResponse(code = 403, message = "Usuário não tem permissão de acesso ao recurso"),
        @ApiResponse(code = 404, message = "Recurso não encontrado"),
        @ApiResponse(code = 422, message = "Erro(s) de validação da camada de negócio"),
        @ApiResponse(code = 500, message = "Erro interno no servidor") })
    public Response consultarRecepcaoPorProtocolo(@QueryParam("TPP-ID") String TPP_ID, @HeaderParam("abi") String abi, @ApiParam(value = "Protocol Number",required=true) @PathParam("protocolNumber") String protocolNumber, @ApiParam(value = "JSON Web Token (JWT) contendo as informações do usuário. Este token é recuperado no parâmetro Set-Token no response da autenticação" ,required=true)@HeaderParam("Authorization") String authorization, @ApiParam(value = "Token de prevenção contra ataques CSRF. Este token é recuperado no parâmetro X-CSRF-Token no response da autenticação" ,required=true)@HeaderParam("X-CSRF-Token") String xCSRFToken);
}

